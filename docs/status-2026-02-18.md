# Status Update — 2026-02-18

## Feature: Plugin Architecture

**Branch:** `claude/charming-mclaren`
**Status:** Implementation complete, ready for review

---

### Summary

Implemented the drop-in plugin system from the project roadmap. Plugins are `.ps1` files placed in the `Plugins/` directory that register new intents, categories, workflows, and metadata without modifying core code.

### Files Created

| File | Purpose |
|------|---------|
| `Modules/PluginLoader.ps1` | Plugin loader — scanning, validation, merging, lifecycle management (~500 lines) |
| `Plugins/_Example.ps1` | Reference template demonstrating all plugin conventions |
| `docs/status-2026-02-18.md` | This status update |

### Files Modified

| File | Change |
|------|--------|
| `Microsoft.PowerShell_profile.ps1` | Loads PluginLoader after core modules; adds `reload-plugins` alias; reload functions re-merge plugins after core reload |
| `Modules/ProfileHelp.ps1` | `tips` shows plugin commands; `profile-timing` shows per-plugin load times; `Get-SafeCommandsPrompt` appends plugin intents to AI system prompt |
| `Modules/IntentAliasSystem.ps1` | `Get-IntentInfo` now shows source attribution (core vs plugin name) |
| `CONTRIBUTING.md` | Updated "New Intent" guide to recommend plugins; added directory tree entry |

### Plugin Convention

A plugin file exports well-known variables that the loader merges into global registries:

| Variable | Required | Merges Into |
|----------|----------|-------------|
| `$PluginIntents` | Yes | `$global:IntentAliases` |
| `$PluginMetadata` | Recommended | `$global:IntentMetadata` |
| `$PluginCategories` | Optional | `$global:CategoryDefinitions` |
| `$PluginWorkflows` | Optional | `$global:Workflows` |
| `$PluginInfo` | Optional | `$global:LoadedPlugins` (version, author, description) |

### Capabilities Delivered

- **Drop-in loading** — place a `.ps1` in `Plugins/`, run `reload-plugins`
- **Enable/Disable** — `Enable-ShelixPlugin` / `Disable-ShelixPlugin` toggle via `_` prefix rename
- **Unregister** — `Unregister-ShelixPlugin` cleanly removes all contributions from registries
- **Scaffolding** — `new-plugin 'Name'` generates a ready-to-edit plugin file
- **Conflict protection** — duplicate intent/workflow names are warned and skipped; core is never overwritten
- **Validation** — rejects non-scriptblock intents, warns on unknown category references
- **AI visibility** — plugin intents are dynamically injected into the LLM system prompt
- **Inspection** — `Get-IntentInfo` shows `Source: plugin: <name>` for plugin intents
- **Timing** — per-plugin load time tracked in `$global:ProfileTimings` and shown by `profile-timing`
- **Tab completion** — all plugin management functions have argument completers
- **Help integration** — `tips` lists plugin commands; `intent-help` shows plugin intents by category

### What's Not Included (future work)

- JSON/YAML-based intent definitions (no PowerShell required) — per roadmap
- Plugin dependency declarations (e.g., "requires WebTools")
- Plugin marketplace / remote install

### Testing Notes

To verify:
1. `Enable-ShelixPlugin 'Example'` — activates the sample plugin
2. `intent '{"intent":"hello_world","name":"Shelix"}'` — runs a plugin intent
3. `Get-IntentInfo 'coin_flip'` — shows source attribution
4. `plugins` — lists active and disabled plugins with metadata
5. `Disable-ShelixPlugin 'Example'` — deactivates and unloads cleanly
